# Прогноз оттока клиентов банка

[ipynb](https://github.com/mvs834/Yandex.Practicum-RUS/blob/5e55632419e4920d443d67e4f711043f6d49dfc7/Bank%20customers%20churn/Bank_customer_churn.ipynb)

## Описание проекта

Необходимо спрогнозировать уйдёт ли клиент из банка на основе исторических данные о поведении клиентов и расторжении договоров с банком.

## Навыки и инструменты

- **python**
- **pandas**
- **numpy**
- matplotlib.**pyplot**
- **seaborn**
- sklearn.linear_model.**LogisticRegression**
- sklearn.tree.**DecisionTreeClassifier**
- sklearn.ensemble.**RandomForestClassifier**

## Ход выполнения проекта
### Загрузка и предобработка
- названия колонок приведены к "змеиному_формату"
- обработаны пропуски в колонке Tenure
- целевой признак не сбалансирован

### Исследование задачи на несбалансированных данных
#### Логистическая регрессия
- категориальные признаки переведены в численные с помощью One Hot Encoder
- признаки независимы друг от друга 
- количественные признаки масштабированы
- выборки разделены, модель обучена

#### Дерево решений, классификация
- категориальные признаки переведены в численные с помощью OrdinalEncoder
- выборки разделены, модель обучена

#### Случайный лес, классификация
- выборки разделены, модель обучена

Вывод: наивысшее значение метрики F1 получилось при обучении модели случайного леса по сравнению с логистической регрессией и деревом решений. Следовательно, далее следует использовать случайный лес

### Борьба с дисбалансом
- Увеличение выборки влечёт увеличение метрики F1, следовательно, далее следует использовать увеличенную выборку
- Максимальная точность, полнота и f1 достигается при пороге 0.4
- Метрика AUC-ROC высокая и график её достаточно крутой

### Тестирование модели
- f1_score: 0.59
- AUC ROC score: 0.8566493552869575

## Вывод

Входные данные подготовлены: оставлены только необходимые параметры, пропуски удалены. Исследование задачи на несбалансированной выборке показало, что модель случайного леса выполняет задачу наилучшим образом. Были подобраны наилучшие гиперпараметры для модели случайного леса методом перебора. Балансировка методом увеличения изначально малочисленной выборки целевого параметра является предпочтительной в связи с высоким значением метрики F1. В итоге построена модель, прогнозирующая уход клиента из банка на основе исторических данных. Модель характеризуется метрикой F1 0.6
